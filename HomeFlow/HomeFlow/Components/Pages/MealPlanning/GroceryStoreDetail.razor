@page "/grocerystore"
@page "/grocerystore/{id:guid}"

<PageTitle>Grocery Store</PageTitle>


<MudContainer Fixed="true">
    @if ( GroceryStore == null )
    {
            <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-7" />
    }
    else
    {
            <MudForm Model="GroceryStore" @ref="@_form" Validation="@(validator.ValidateValue)" ValidationDelay="0">

                <MudPaper Class="pa-4">
                    <MudText Typo="Typo.h6">Store Info</MudText>
                    <MudGrid>
                        <MudItem sm="12" xs="12">
                            <MudTextField @bind-Value="GroceryStore.Name" For="@(() => GroceryStore.Name)" Label="Name" Variant="Variant.Outlined" />
                            <MudTextField @bind-Value="GroceryStore.Location" For="@(() => GroceryStore.Location)" Label="Location" Variant="Variant.Outlined" />
                        </MudItem>
                    </MudGrid>
                </MudPaper>

                    <MudPaper Class="pa-4 mt-4">
                        <MudGrid>
                            <MudItem md="12" sm="12" xs="12">
                                    <MudStack StretchItems="StretchItems.Start" Row>
                                    <MudText Typo="Typo.h6">Aisles</MudText>
                                    <MudButton OnClick="AddAisle" Size="Size.Small" Color="Color.Primary" Variant="Variant.Filled">Add</MudButton>
                                </MudStack>
                                <MudDropContainer T="GroceryStoreAisle"
                                    Items="@GroceryStore.GroceryStoreAisles"
                                    ItemDropped="ReorderItems"
                                    ItemsSelector="@((item,dropzone) => string.Empty == dropzone)"
                                    Class="d-flex flex-wrap flex-grow-1 mt-4"
                                    @ref="_dropContainer">
                                    <ChildContent>
                                        <MudPaper Elevation="0" Class="flex-grow-1">
                                            <MudList T="GroceryStoreAisle" Class="d-flex flex-column mud-height-full" @bind-SelectedValue="_selectedGroceryStoreAisle" ReadOnly SelectionMode="SelectionMode.SingleSelection">
                                                <MudDropZone T="GroceryStoreAisle" Identifier="" Class="flex-grow-1" AllowReorder="true" />
                                            </MudList>
                                        </MudPaper>
                                    </ChildContent>
                                    <ItemRenderer>
                                        <MudListItem T="GroceryStoreAisle" Icon="@Icons.Material.Filled.Reorder" Value="@context">
                                             <MudStack StretchItems="StretchItems.Start" Row>
                                                <MudText>@context.Name</MudText>
                                                <MudIconButton Size="Size.Small" Icon="@Icons.Material.Filled.Edit" aria-label="edit" OnClick="@(() => EditAisle(context.Id))" />
                                                <MudIconButton Size="Size.Small" Icon="@Icons.Material.Filled.Delete" aria-label="delete" OnClick="@(() => DeleteAisle(context.Id))" />
                                            </MudStack>
                                        </MudListItem>
                                            <MudDivider />
                                    </ItemRenderer>
                                </MudDropContainer>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>

                <MudPaper Class="pa-4 mt-4">
                    <MudGrid>
                        <MudItem md="12" sm="12" xs="12">
                            <MudButton OnClick="Save" Variant="Variant.Filled" Color="Color.Primary">Save</MudButton>
                            <MudButton OnClick="Cancel" Variant="Variant.Text" Color="Color.Secondary">Cancel</MudButton>
                        </MudItem>
                    </MudGrid>
                </MudPaper>
            </MudForm>

    }
</MudContainer>